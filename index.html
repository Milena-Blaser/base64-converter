<!DOCTYPE html>
<html>
  <body>
    <input type="file" id="imageInput" accept="image/*" />
    <button onclick="uploadImage()">Upload</button>
    <p id="resultText"></p>

    <script>
      async function uploadImage() {
        const input = document.getElementById('imageInput');
        const file = input.files[0];

        if (!file) {
          alert('Please choose a file');
          return;
        }

        // Convert to base64 so you can send the image to Thunkable
        const reader = new FileReader();
        reader.onload = async () => {
          const base64Image = reader.result; // data:image/...;base64,...

          const formData = new FormData();
          formData.append('image', file);

          try {
            const response = await fetch('https://ocr-extract-text.p.rapidapi.com/ocr', {
              method: 'POST',
              headers: {
                'X-RapidAPI-Key': 'f1caff3209msh94024445c238227p136385jsna77dff3623be',
                'X-RapidAPI-Host': 'ocr-extract-text.p.rapidapi.com'
              },
              body: formData
            });

            const result = await response.json();
            const text = result.text || 'No text found';

            // Send result + image back to Thunkable
            if (window.ReactNativeWebView) {
              window.ReactNativeWebView.postMessage(JSON.stringify({
                text: text,
                image: base64Image
              }));
            }

            document.getElementById('resultText').innerText = text;

          } catch (error) {
            console.error('Upload failed', error);
            alert('OCR failed');
          }
        };

        reader.readAsDataURL(file); // Start reading the file as base64
      }
    </script>
  </body>
</html>
