<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>OCR Upload</title>
  </head>
  <body>
    <input type="file" id="fileInput" accept="image/*" />
    <p id="result">Select an image to begin.</p>

    <script>
      const apiUrl = 'https://ocr-extract-text.p.rapidapi.com/ocr';
      const rapidApiKey = '11083d3e5emsh163c76e8056d4a5p1d3e0cjsnba8f2be5464a';

      document.getElementById('fileInput').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const formData = new FormData();
        formData.append('file', file);

        try {
          const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
              'X-RapidAPI-Key': rapidApiKey,
              'X-RapidAPI-Host': 'ocr-extract-text.p.rapidapi.com'
            },
            body: formData
          });

          const data = await response.json();
          const text = data.text || 'No text found';

          document.getElementById('result').innerText = text;
          if (window.postMessage) {
            window.postMessage(text, '*');
          }

        } catch (error) {
          document.getElementById('result').innerText = 'Error: ' + error.message;
          if (window.postMessage) {
            window.postMessage('ERROR: ' + error.message, '*');
          }
        }
      });
    </script>
  </body>
</html>
